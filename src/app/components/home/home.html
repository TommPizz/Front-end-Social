<div class="home-container">
  <div class="top-bar">
    <button class="logout-btn" (click)="logout()">Logout</button>
  </div>
  <h1>Feed dei Post</h1>


  <!-- Loading spinner -->
  @if (loading()) {
    <div class="loading">
      <p>Caricamento post in corso...</p>
    </div>
  }

  <!-- Messaggio di errore -->
  @if (error() && error().length > 0) {
    <div class="error-message">
      {{ error() }}
      <button (click)="loadPosts()">Riprova</button>
    </div>
  }

  <!-- Lista dei post -->
  @if (!loading() && !error()) {
    <div class="posts-list">
      @if (posts().length === 0) {
        <div class="no-posts">
          <p>Nessun post disponibile</p>
        </div>
      }

      @for (post of posts(); track post.id) {
        <div class="post-card">
          <div class="post-header">
            <div class="user-info">
              <span class="username">{{ post.nomeUtente }}</span>
              <span class="date">{{ formatDate(post.dataOra) }}</span>
            </div>
          </div>

          <div class="post-content">
            <p>{{ post.contenuto }}</p>
          </div>

          <div class="post-footer">
            <div class="likes">
              <span class="like-icon">‚ù§Ô∏è</span>
              <span class="like-count">{{ post.numeroLike || post.like?.length || 0 }}</span>
            </div>
            <div class="comments">
              <span class="comment-icon">üí¨</span>
              <span class="comment-count">{{ post.commenti?.length || 0 }}</span>
            </div>
          </div>

          <!-- Sezione commenti (opzionale) -->
          @if (post.commenti && post.commenti.length > 0) {
            <div class="comments-section">
              <h4>Commenti:</h4>
              @for (commento of post.commenti; track commento.idCommento) {
                <div class="comment">
                  <strong>{{ commento.utente?.username || 'Utente' }}</strong>: {{ commento.testo }}
                </div>
              }
            </div>
          }
        </div>
      }
    </div>
  }
</div>